<!DOCTYPE html>
<html lang="en">

<head>
  <title>AIO-Annivators</title>
  <meta property="og:title" content="AIO-Annivators" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta charset="utf-8" />

  <style data-tag="reset-style-sheet">
    html {
      line-height: 1.15;
    }

    body {
      margin: 0;
    }

    * {
      box-sizing: border-box;
      border-width: 0;
      border-style: solid;
    }

    p,
    li,
    ul,
    pre,
    div,
    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    figure,
    blockquote,
    figcaption {
      margin: 0;
      padding: 0;
    }

    button {
      background-color: transparent;
    }

    button,
    input,
    optgroup,
    select,
    textarea {
      font-family: inherit;
      font-size: 100%;
      line-height: 1.15;
      margin: 0;
    }

    button,
    select {
      text-transform: none;
    }
    
    a {
      color: inherit;
      text-decoration: inherit;
    }

    input {
      padding: 2px 4px;
    }

    img {
      display: block;
    }

    html {
      scroll-behavior: smooth
    }
    .btnclicked {
      background-color: #f03fb2 !important;
    }
  </style>
  <style data-tag="default-style-sheet">

    body {
      font-weight: 400;
      font-style: normal;
      text-decoration: none;
      text-transform: none;
      letter-spacing: normal;
    }
  </style>
</head>

<body>
  <div>
    <link href="../static/index.css" rel="stylesheet" />
    <div id="divMain">
      <div id="divPreview">
      
          <h2 style="margin: 5px;"> Preview result </h2>
          <div>
          <input type="text" placeholder="Query index" class="input" id="inpQueryId"/>
          
          <button type="button" class="btnControl" onclick="ExportRes(this)"> Export</button>
          <button type="button" class="btnControl" onclick="openPreview()"> ‚ùå </button>
            </div>
        
        <textarea id="inpPreviewRes">
   
        </textarea>
      </div>
      <div id="divSearchObj">

        <!-- Current scene BBox-->
        <div id="divQueryAndControlObj">
          <div class="divQueryObj">
            <div class="textarea" ondrop="drop(event)" ondragover="allowDrop(event)" id="divDrawBBox"></div>

            <div style="margin-top: 4px;">
              <textarea placeholder="OCR" class="inpExtraSearch1 textarea enterToSearch" id="inpOCR"></textarea>
              <textarea placeholder="ASR" class="inpExtraSearch1 textarea enterToSearch" id="inpASR"></textarea>
              <textarea placeholder="MinObj" class="inpExtraSearch2 textarea enterToSearch" id="inpMaxObj"></textarea>
              <textarea placeholder="ColorClass" class="inpExtraSearch2 textarea enterToSearch" id="inpMaxColor"></textarea>
              <textarea placeholder="NumObj" class="inpExtraSearch2 textarea enterToSearch" id="inpNumObj"></textarea>
            </div>
          </div>


          <div class="divBBoxTools">
            <div class="inpBBoxTools textarea"
              onclick="showDropDownBBoxTools(0)">Labels</div>
            <div class="dropDownBBoxTools">
              <span class="itemInDropDownBBoxTools" onclick="showItemBBoxTools(0)">1. Animal</span>
              <div class="containLabel">
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">bear</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">bird</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">cat</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">cow</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">dog</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">elephant</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">giraffe</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">horse</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">person</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">sheep</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">zebra</div>

              </div>

              <span class="itemInDropDownBBoxTools" onclick="showItemBBoxTools(1)">2. Eating Utensil</span>
              <div class="containLabel">
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">bottle</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">bowl</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">cup</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">fork</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">knife</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">spoon</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">wine_glass</div>
              </div>
              <span class="itemInDropDownBBoxTools" onclick="showItemBBoxTools(2)">3. Electronic Device</span>
              <div class="containLabel">
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">cell_phone</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">keyboard</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">laptop</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">microwave</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">mouse</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">oven</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">refrigerator</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">remote</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">toaster</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">tv</div>

              </div>
              <span class="itemInDropDownBBoxTools" onclick="showItemBBoxTools(3)">4. Fruit</span>
              <div class="containLabel">
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">apple</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">banana</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">broccoli</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">cake</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">carrot</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">donut</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">hot_dog</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">orange</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">pizza</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">sandwich</div>

              </div>
              <span class="itemInDropDownBBoxTools" onclick="showItemBBoxTools(4)">5. Furniture</span>
              <div class="containLabel">
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">bed</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">chair</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">clock</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">couch</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">dining_table</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">potted_plant</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">toilet</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">vase</div>

              </div>
              <span class="itemInDropDownBBoxTools" onclick="showItemBBoxTools(5)">6. PersonalItem</span>
              <div class="containLabel">
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">backpack</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">book</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">handbag</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">suitcase</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">umbrella</div>

              </div>
              <span class="itemInDropDownBBoxTools" onclick="showItemBBoxTools(6)">7. SportItem</span>
              <div class="containLabel">
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">baseball_bat</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">baseball_glove</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">kite</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">skateboard</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">skis</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">snowboard</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">sports_ball</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">surfboard</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">tennis_racket</div>

              </div>
              <span class="itemInDropDownBBoxTools" onclick="showItemBBoxTools(7)">8. Vehicle</span>
              <div class="containLabel">
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">airplane</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">bicycle</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">boat</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">bus</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">car</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">motorcycle</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">train</div>
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">truck</div>

              </div>
              <span class="itemInDropDownBBoxTools" onclick="showItemBBoxTools(8)">9. Color</span>
              <div class="containLabel">
                <div class="itemLabel" draggable="true" ondragstart="drag(event)">black</div>
                  <div class="itemLabel" draggable="true" ondragstart="drag(event)">blue</div>
                  <div class="itemLabel" draggable="true" ondragstart="drag(event)">brown</div>
                  <div class="itemLabel" draggable="true" ondragstart="drag(event)">gray</div>
                  <div class="itemLabel" draggable="true" ondragstart="drag(event)">green</div>
                  <div class="itemLabel" draggable="true" ondragstart="drag(event)">orange</div>
                  <div class="itemLabel" draggable="true" ondragstart="drag(event)">pink</div>
                  <div class="itemLabel" draggable="true" ondragstart="drag(event)">purple</div>
                  <div class="itemLabel" draggable="true" ondragstart="drag(event)">red</div>
                  <div class="itemLabel" draggable="true" ondragstart="drag(event)">white</div>
                  <div class="itemLabel" draggable="true" ondragstart="drag(event)">yellow</div>


                </div>
              </div>
            <input class="inpBBoxTools textarea"
              onclick="showDropDownBBoxTools(1)" placeholder="Search label..." onkeyup="SearchItems(0)" id="inpLabelSearch">
            <div class="dropDownBBoxTools" id="containerLabelSearch">
              </div>
            <div id="containerTags">

            </div>

            <input class="inpBBoxTools textarea"
              onclick="showDropDownBBoxTools(2)" placeholder="Search tag..." onkeyup="SearchItems(1)" id="inpTagSearch">
            <div class="dropDownBBoxTools" id="containerTagSearch">
              </div>
           

            <div class="inpBBoxTools textarea" onclick="showDropDownBBoxTools(3)">Tags</div>
            <div class="dropDownBBoxTools" id="containerTagRec">

            </div>
            
            <div>
              <input type="text" placeholder="topk" class="inpTopk input enterToSearch" id="topkBBox"/>
              <input type="checkbox" onclick="controlTick(0)" style="margin-top: 5px;"/>
              <span>Fusion</span>
            </div>
          </div>

        </div>
        <div id="divControlBBox">
          <button type="button" class="btnControl button btnGroup" onclick="groupbtn(this, 0)">
            Group
          </button>
          <button type="button" class="btnControl button btnHideID" onclick="hideID(this, 0)">
            Hide ID
          </button>
          <button type="button" class="btnControl button" onclick="removeAllBBoxes()">
            ‚ùå boxes
          </button>
          <button type="button" class="btnControl button" onclick="removeAllTags()">
            ‚ùå tags
          </button>
          <button type="button" class="btnControl button" onclick="removeAll()">
            ‚ùå all
          </button>
          <button type="button" class="btnControl button" onclick="zoomframe(0, 0)">
            -
          </button>
          <button type="button" class="btnControl button" onclick="zoomframe(1, 0)">
            +
          </button>
          
          <button type="button" class="btnSearch button" onclick="Search('metadata')">
            üîç
          </button>
          
        </div>



        <div class="divObjAllRes">
          <div class="divObjRes" ondrop="dropFrame(event)" ondragover="allowDrop(event)">
           

          </div>
        </div>
      </div>

      <div class="divSearchTxt">
        <div id="divQueryAndControlTxt">

          <!-- Current scene Txt-->
          <div class="divQueryTxt">
            <textarea placeholder="Query" class="textarea inpQueryTxt enterToSearch" id="inpTxtCurrent"></textarea>
            <textarea placeholder="Query" class="textarea inpQueryTxt enterToSearch" id="inpTxtNext"></textarea>
            {% if model_list[0] %}
            <div>
              <input type="checkbox" onclick="controlTick(20)"/>
              <span>CLIP-H/14</span>
            </div>
            {% endif %}

            {% if model_list[1] %}
            <div>
              <input type="checkbox" onclick="controlTick(21)"/>
              <span>CLIP-H/14-XLM</span>
            </div>
            {% endif %}

            {% if model_list[2] %}
            <div>
              <input type="checkbox" onclick="controlTick(22)"/>
              <span>CLIP-L/14</span>
            </div>
            {% endif %}

            {% if model_list[3] %}
            <div>
              <input type="checkbox" onclick="controlTick(23)"/>
              <span>BLIP-VIT</span>
            </div>  
            {% endif %}

            {% if model_list[4] %}
            <div>
              <input type="checkbox" onclick="controlTick(24)"/>
              <span>BLIP-PRETRAIN</span>
            </div>  
            {% endif %}

            {% if model_list[5] %}
            <div>
              <input type="checkbox" onclick="controlTick(25)"/>
              <span>BEIT</span>
            </div>  
            {% endif %}

            {% if model_list[6] %}
            <div>
              <input type="checkbox" onclick="controlTick(26)"/>
              <span>BEIT-LARGE</span>
            </div>  
            {% endif %}
          </div>

          <div class="divOptionTxt">
            <button type="button" class="btnControl button" onclick="hideDivMeta()">
              Meta-S
            </button>
            <input type="text" placeholder="topk" class="inpTopk input enterToSearch" id="topkTxt"/>
            <div class="divSelect">
              <select class="selectBar" id="selectFilter">
                <option value='0'>Empty search history</option>
              </select>
              <button type="button" class="btnControl button" onclick="clearHistory()">
                Clear
              </button>
            </div>
            <span style="margin: 0px;">L</span><input placeholder="01" class="textarea enterToSearch" id="inpL"/>
            <span style="margin: 0px;">/V</span><input placeholder="001" class="textarea enterToSearch" id="inpV"/>
            <div>
              <input type="checkbox" onclick="controlTick(4)" />
              <span>Fusion</span>
            </div>
            <div>
              <input type="checkbox" checked="true" onclick="controlTick(5)" />
              <button onclick="sendFeedback()" class="btnControl btn">Feedback</button>
            </div>
            <div>
              <input type="checkbox" checked="true" onclick="controlTick(7)" />
              <button onclick="sendUpvote()" class="btnControl btn">Upvote</button>
            </div>
            <button type="button" class="btnControl button btnGroup" onclick="groupbtn(this, 1)">
              Group
            </button>
            <button type="button" class="btnControl button btnHideID" onclick="hideID(this, 1)">
              Hide ID
            </button>
            <button type="button" class="btnControl button" onclick="zoomframe(0, 1)">
              -
            </button>
            <button type="button" class="btnControl button" onclick="zoomframe(1, 1)">
              +
            </button>
            <button type="button" class="btnSearch button" onclick="Search('embedding')">
              üîç
            </button>
            <input type="text" placeholder="VQA" class="inpTopk input" id="inpVQA"/>
            <button type="button" class="btnSearch button" onclick="openPreview()" style="background-color: green;">
              ‚¨áÔ∏è
            </button>
          </div>




        </div>

        <div class="divObjAllRes">
          <div class="divObjRes">

          </div>
        </div>

      </div>
    </div>
  </div>

  <script>
    // --------------------Variable--------------------
    var dropDownBBoxTools = document.getElementsByClassName("dropDownBBoxTools");
    var containLabel = document.getElementsByClassName("containLabel");
    var isCurrentScene = [true, true]; // 0: BBox, 1: Txt
    var drawingAreas = document.getElementById('divDrawBBox');
    var numObj = 0;
    var startX, startY, rect, isDrawing = false;
    const colorList = ['black', 'blue', 'brown', 'green', 'gray', 'orange', 'pink', 'purple', 'red', 'white', 'yellow'];
    
    var leftOfLineMatrix = [16, 62, 107, 153, 199, 245, 290, 335],
        topOfLineMatrix = [16, 42, 68, 94, 119, 145, 171, 195];
    var idCol = ['a', 'b', 'c', 'd', 'e', 'f', 'g'],
        idRow = ['0', '1', '2', '3', '4', '5', '6'];

    var divRes = document.getElementsByClassName('divObjAllRes');
    var isHideID = [false, false];
    var isFeedback = true;
    var isGroup = [false, false];

    var ResDict = [
      { 
        // BBox
      0: ['./distilled_keyframe/L06/V013/34328.jpg', 1],
      1: ['./distilled_keyframe/L06/V013/34329.jpg', 1],
      2: ['./distilled_keyframe/L06/V013/34330.jpg', 1],
      3: ['./distilled_keyframe/L06/V013/34331.jpg', 1],
      4: ['./distilled_keyframe/L06/V013/34332.jpg', 1],
      5: ['./distilled_keyframe/L06/V013/34333.jpg', 1],
      6: ['./distilled_keyframe/L06/V013/34334.jpg', 1],
      7: ['./distilled_keyframe/L06/V013/34335.jpg', 1],
      8: ['./distilled_keyframe/L06/V013/34336.jpg', 1],
      9: ['./distilled_keyframe/L06/V013/34337.jpg', 1],
      10: ['./distilled_keyframe/L06/V013/34338.jpg', 1]
      },
      { 
        // Text
      0: ['./distilled_keyframe/L06/V013/34328.jpg', 1],
      1: ['./distilled_keyframe/L06/V013/34329.jpg', 1],
      2: ['./distilled_keyframe/L06/V013/34330.jpg', 1],
      3: ['./distilled_keyframe/L06/V013/34331.jpg', 1],
      4: ['./distilled_keyframe/L06/V013/34332.jpg', 1],
      5: ['./distilled_keyframe/L06/V013/34333.jpg', 1],
      6: ['./distilled_keyframe/L06/V013/34334.jpg', 1],
      7: ['./distilled_keyframe/L06/V013/34335.jpg', 1],
      8: ['./distilled_keyframe/L06/V013/34336.jpg', 1],
      9: ['./distilled_keyframe/L06/V013/34337.jpg', 1],
      10: ['./distilled_keyframe/L06/V013/34338.jpg', 1]
      }
    ];
    
    
    var txtVideoRes = document.getElementsByClassName('txtVideoRes');

    var listTags = new Set();

    var inpOCR = document.getElementById('inpOCR'),
          inpASR = document.getElementById('inpASR'),
          inpMaxObj = document.getElementById('inpMaxObj'),
          inpMaxColor = document.getElementById('inpMaxColor'),
          inpNumObj = document.getElementById('inpNumObj'),
          inpTopkBbox = document.getElementById('topkBBox'),
          inpTopkTxt = document.getElementById('topkTxt'),
          inpTxtCurrent = document.getElementById('inpTxtCurrent'),
          inpTxtNext = document.getElementById('inpTxtNext'),
          inpL = document.getElementById('inpL'),
          inpV = document.getElementById('inpV'),
          selectFilter = document.getElementById('selectFilter');

    var fussionTxt = false,
        fussionBBox = false,
        useClipH = false, useClipH_XLM = false, useClipL = false, useBlipVit = false, useBlipPretrain = false, useBeit = false, useBeitLarge = false;
        isFeedback = true;

    var historySearch = [''];
    var nHistory = 0, currentHistory = 0;

    var neg_keyframe_subset = new Set(), pos_keyframe_subset = new Set();

    var divControlTxt = document.getElementById('divQueryAndControlTxt'), divControlMeta = document.getElementById('divQueryAndControlObj'), divPreview = document.getElementById('divPreview'), divMeta = document.getElementById('divSearchObj');

    var enterToSearchTxt = divControlTxt.getElementsByClassName('enterToSearch'), enterToSearchMeta = divControlMeta.getElementsByClassName('enterToSearch');
    var frameWidth = [160, 160], frameHeight = [103, 103];

    var isPreview = false;

    var contentcsv = '';

    var inpQueryId = document.getElementById('inpQueryId'),
        inpVQA = document.getElementById('inpVQA'),
        inpPreviewRes = document.getElementById('inpPreviewRes');

    var isUpvote = true;

    var selectedUpvote = new Set();
    //--------------------Function--------------------

    /* Show dropdown when click Labels, Labels recommend, Tags, Tags recommend */
    function showDropDownBBoxTools(index) {
      let container = dropDownBBoxTools[index];
      if (container.style.display == "flex") {
        container.style.display = "none";
       // return false;
      } else {
        if (index === 3) { // open tag recommendation
           tagRecommend();
        }
        container.style.display = "flex";
       // return true;
      }
    }

    /* Show label or tag in category when click item in dropdown */
    function showItemBBoxTools(index) {
      let container = containLabel[index];
      if (container.style.display == "flex") {
        container.style.display = "none";
      } else {
        container.style.display = "flex";
      }
    }

    /* Function control labels & bboxes in ObjSearch */
    function drawRectangle(e) {
      let width = e.pageX - startX;
      let height = e.pageY - startY;
      rect.style.width = `${Math.abs(width)}px`;
      rect.style.height = `${Math.abs(height)}px`;

      if (width < 0) rect.style.left = `${e.pageX}px`;
      if (height < 0) rect.style.top = `${e.pageY}px`;
    }
    function deleteByID(objID, containerObj) {
      let objDelete = containerObj.getElementsByClassName(objID);
      Array.from(objDelete).forEach(function (element) {
        element.remove();
      });
    }
    function addRectangleControls(obj, containerObj) {
      let top = parseInt(obj.style.top, 10),
          left = parseInt(obj.style.left, 10),
          width = parseInt(obj.style.width, 10),
          height = parseInt(obj.style.height, 10),
          objid = obj.classList[0];

      const btnDelete = document.createElement('div');
      btnDelete.className = `${objid} delete-button`;
      btnDelete.innerHTML = 'x';
      btnDelete.style.top = (top - 10) + 'px';
      btnDelete.style.left = (left + width - 10) + 'px';

      btnDelete.addEventListener('click', function () {
        deleteByID(objid, containerObj);
      });
      containerObj.appendChild(btnDelete);

      ['top-left', 'bottom-left', 'bottom-right'].forEach(pos => {
        const handle = document.createElement('div');
        handle.className = `${objid} resize-handle ${pos}`;
        handle.addEventListener('dblclick', function (e) {
          changeLabel(e, containerObj);
        });
        handle.addEventListener('mousedown', function (e) {
          startResize(e, containerObj);
        });
        if (pos === 'top-left') {
          handle.style.top = (top - 4) + 'px';
          handle.style.left = (left - 4) + 'px';
        } else if (pos === 'bottom-left') {
          handle.style.top = (top + height - 4) + 'px';
          handle.style.left = (left - 4) + 'px';
        } else {
          handle.style.top = (top + height - 4) + 'px';
          handle.style.left = (left + width - 4) + 'px';
        }
        containerObj.appendChild(handle);
      });
    }

    function startResize(e, containerObj) {
      e.stopPropagation();
      let handle = e.target;
      let id = handle.classList[0];
      let allElementWithID = containerObj.getElementsByClassName(id);
      let rect = allElementWithID[0];
      let deleteButton = allElementWithID[1];
      let toplefthandle = allElementWithID[2];
      let bottomlefthandle = allElementWithID[3];
      let bottomrighthandle = allElementWithID[4];
      let startX = e.clientX;
      let startY = e.clientY;
      let startWidth = rect.offsetWidth;
      let startHeight = rect.offsetHeight;
      let startLeft = rect.offsetLeft;
      let startTop = rect.offsetTop;

      function resize(e) {
        if (handle.classList.contains('top-left')) {
          rect.style.width = `${startWidth - (e.clientX - startX)}px`;
          rect.style.height = `${startHeight - (e.clientY - startY)}px`;
          rect.style.left = `${startLeft + (e.clientX - startX)}px`;
          rect.style.top = `${startTop + (e.clientY - startY)}px`;
        } else if (handle.classList.contains('top-right')) {
          rect.style.width = `${startWidth + (e.clientX - startX)}px`;
          rect.style.height = `${startHeight - (e.clientY - startY)}px`;
          rect.style.top = `${startTop + (e.clientY - startY)}px`;
        } else if (handle.classList.contains('bottom-left')) {
          rect.style.width = `${startWidth - (e.clientX - startX)}px`;
          rect.style.height = `${startHeight + (e.clientY - startY)}px`;
          rect.style.left = `${startLeft + (e.clientX - startX)}px`;
        } else if (handle.classList.contains('bottom-right')) {
          rect.style.width = `${startWidth + (e.clientX - startX)}px`;
          rect.style.height = `${startHeight + (e.clientY - startY)}px`;
        }
        deleteButton.style.top = (parseInt(rect.style.top, 10) - 10) + 'px';
        deleteButton.style.left = (parseInt(rect.style.left, 10) + parseInt(rect.style.width, 10) - 10) + 'px';

        toplefthandle.style.top = (parseInt(rect.style.top, 10) - 4) + 'px';
        toplefthandle.style.left = (parseInt(rect.style.left, 10) - 4) + 'px';

        bottomlefthandle.style.top = (parseInt(rect.style.top, 10) + parseInt(rect.style.height, 10) - 4) + 'px';
        bottomlefthandle.style.left = (parseInt(rect.style.left, 10) - 4) + 'px';

        bottomrighthandle.style.top = (parseInt(rect.style.top, 10) + parseInt(rect.style.height, 10) - 4) + 'px';
        bottomrighthandle.style.left = (parseInt(rect.style.left, 10) + parseInt(rect.style.width, 10) - 4) + 'px';


      }

      function stopResize() {
        document.removeEventListener('mousemove', resize);
        document.removeEventListener('mouseup', stopResize);
      }

      document.addEventListener('mousemove', resize);
      document.addEventListener('mouseup', stopResize);
    }

    function changeLabel(e, containerObj) {
      e.preventDefault();
      let handleID = e.target.classList[0];
      let allElementWithID = containerObj.getElementsByClassName(handleID);
      let rect = allElementWithID[0];
      let userReLabel = prompt("New label:");
      if (userReLabel) {
        rect.innerText = userReLabel;
      }
    }
    /* Control label drop */
    function drag(event) {
      event.dataTransfer.setData("text", event.target.innerHTML);
    }
    function allowDrop(event) {
      event.preventDefault();
    }
    function drop(event) {
      event.preventDefault();
      let container = drawingAreas;
      let rect = container.getBoundingClientRect();
      let leftContainer = rect.left + window.scrollX;
      let rightContainer = rect.right + window.scrollX - 25;
      let topContainer = rect.top + window.scrollY;
      let bottomContainer = rect.bottom + window.scrollY - 25;
      // Check if the drop is within the container
      event.pageX = Math.max(leftContainer, Math.min(rightContainer, event.pageX));
      event.pageY = Math.max(topContainer, Math.min(bottomContainer, event.pageY));

      let label = event.dataTransfer.getData("text");

      let containerimg = document.createElement('div');
      containerimg.className = `objID${numObj++} rectangleDraw`;
      containerimg.style.position = 'absolute';
      containerimg.style.left = (event.pageX - 6) + "px";
      containerimg.style.top = (event.pageY - 6) + "px";
      containerimg.style.width = '30px';
      containerimg.style.height = '30px';
      containerimg.innerHTML = label;
      container.appendChild(containerimg);
      addRectangleControls(containerimg, container);

    }

    /* Control rectangle in 'Object & colors' */
    function drawBBoxInit() {
      let drawingArea = drawingAreas;
      drawingArea.addEventListener('mousedown', function (e) {
        if (e.target.tagName === 'IMG' || e.target.className.includes('resize-handle') || e.target.className.includes('delete-button')) return;
        if (isDrawing) return;
        startX = e.pageX;
        startY = e.pageY;
        isDrawing = true;
        rect = document.createElement('div');
        rect.className = `objID${numObj++} rectangleDraw`;
        rect.style.left = `${startX}px`;
        rect.style.top = `${startY}px`;
        drawingArea.appendChild(rect);

        drawingArea.addEventListener('mousemove', drawRectangle);
      });

      drawingArea.addEventListener('mouseup', function (e) {
        if (e.target.tagName === 'IMG' || e.target.className.includes('resize-handle') || e.target.className.includes('delete-button')) return;
        if (!isDrawing) return;
        isDrawing = false;
        drawingArea.removeEventListener('mousemove', drawRectangle);

        let userText = prompt("Label:");
        if (userText) {
          rect.innerText = userText;
          addRectangleControls(rect, drawingArea);
          rect = null;
        } else {
          drawingArea.removeChild(rect);
          numObj--;
        }
      });

    }

    /* Gen Query */
    function metaQuery() {
      // BBox
      let objectbbox = '', colorbbox = '', objectnum = inpNumObj.value, objectclass = '', colorclass = '';
      let ocr = inpOCR.value, tag = [...listTags].join(" "), topk = inpTopkBbox.value;

      let containerObj = drawingAreas;
      let listObjBBox = containerObj.getElementsByClassName('rectangleDraw');
      for (let obj of listObjBBox) {
        let top = parseInt(obj.style.top, 10);
        let left = parseInt(obj.style.left, 10);
        let bot = top + parseInt(obj.style.height, 10) - 1;
        let right = left + parseInt(obj.style.width, 10) - 2;
        let label = obj.innerHTML;

        let checkLeft = false;
        for (let i = 1; i < 8; i++) {
          if (!checkLeft) {
            if (left < leftOfLineMatrix[i] - 1 && left >= leftOfLineMatrix[i - 1] - 1) {
              checkLeft = true;
            } else continue;
          } else {
            if (right < leftOfLineMatrix[i - 1] + 1) break;
          }
          let checkTop = false;
          for (let j = 1; j < 8; j++) {
            if (!checkTop) {
              if (top < topOfLineMatrix[j] - 1 && top >= topOfLineMatrix[j - 1] - 1) {
                checkTop = true;
              } else continue;
            } else {
              if (bot < topOfLineMatrix[j - 1] + 1) break;
            }
            if (colorList.includes(label)) {
              colorbbox += idCol[i - 1] + idRow[j - 1] + label + ' ';
            } else {
              objectbbox += idCol[i - 1] + idRow[j - 1] + label + ' ';
            }
          }
        }
      }

      // oclass
      let listObjOclass = inpMaxObj.value.trim().split(' '),
          listColor = inpMaxColor.value.trim().split(' ');

      // encode obj
      for (let i = 0, maxi = listObjOclass.length; i < maxi; i += 2) {
        let num = parseInt(listObjOclass[i], 10), obj = listObjOclass[i + 1];
        for (let j = 1; j <= num; ++j) {
          objectclass += obj + j + ' ';
        }
      }

      // encode color
      for (let i = 0, maxi = listColor.length; i < maxi; i += 2) {
        let num = parseInt(listColor[i], 10), obj = listColor[i + 1];
        for (let j = 1; j <= num; ++j) {
            colorclass += obj + ' ';
        }
      }
      
      return ['metadata', 2, topk, fussionBBox, ocr, tag, objectclass, colorclass, objectbbox, objectnum, colorbbox];
    }

    function txtQuery() {
      let typeSearch = 'embedding';
      let local_L = '', local_V = '';
      let queryCurrent = inpTxtCurrent.value, queryNext = inpTxtNext.value;
      if (inpL.value !== '' && inpV.value !== '') {
        local_L = 'L'+inpL.value; local_V = 'V'+inpV.value;
        if (queryCurrent === '' && queryNext === '') { // Show keyframe in local
          return ['keyframe', local_L, local_V];
        }
      }
      
      let topk = inpTopkTxt.value;
      return [typeSearch, 2, topk, fussionTxt, queryCurrent, queryNext, local_L, local_V, useClipH, useClipH_XLM, useClipL, useBlipVit, useBlipPretrain, useBeit, useBeitLarge];
    }

    /* control when tick checkbox, idScene=0 when current and =1 when next */
    function controlTick(idTick) {
      if (idTick === 0) {
        fussionBBox = !fussionBBox; return;
      } 
      if (idTick === 5) {
        isFeedback = !isFeedback; feedbackbtn(); return;
      }
      if (idTick === 4) {
        fussionTxt = !fussionTxt; return;
      }
      if (idTick === 7) {
        isUpvote = !isUpvote; upvotebtn(); return;
      }

      if (idTick === 20) {
        useClipH = !useClipH; return;
      }
      if (idTick === 21) {
        useClipH_XLM = !useClipH_XLM; return;
      }
      if (idTick === 22) {
        useClipL = !useClipL; return;
      }
      if (idTick === 23) {
        useBlipVit = !useBlipVit; return;
      }
      if (idTick === 24) {
        useBlipPretrain = !useBlipPretrain; return;
      }
      if (idTick === 25) {
        useBeit = !useBeit; return;
      }
      if (idTick === 26) {
        useBeitLarge = !useBeitLarge; return;
      }

    }

    /* Click btn Feedback in Txt */
    function feedbackbtn() {
      let feedback = divRes[1].getElementsByClassName('btnRecAndNotRec');
      if (isFeedback) {
        for (let btn of feedback) {
          btn.style.display = 'flex';
        }
      } else {
        for (let btn of feedback) {
          btn.style.display = 'none';
          btn.classList.remove('clickedRec');
        }
      }
    }

    /* Click btn upvote in Txt */
    function upvotebtn() {
      let upvote = divRes[1].getElementsByClassName('btnUpvote');
      if (isUpvote) {
        for (let btn of upvote) {
          btn.style.display = 'flex';
        }
      } else {
        for (let btn of upvote) {
          btn.style.display = 'none';
          btn.classList.remove('clickedVote');
        }
      }
    }
    /* Click btn Group in BBox (id=0) and Txt (id=1) */
    function groupbtn(btn, id) {
      isGroup[id] = !isGroup[id];
      if (isGroup[id]) {
        btn.innerHTML = 'Ungroup';
        displayResGroup(id);
       
      } else {
        btn.innerHTML = 'Group';
        displayRes(id);

      }
    }
    /* Click btn HideID in BBox (id=0) and Txt (id=1) */
    function hideID(btn, id) {
      let divID = divRes[id].getElementsByClassName('txtIDFrame');
      isHideID[id] = !isHideID[id];
      if (isHideID[id]) {
        for (let idFrame of divID) {
          idFrame.style.display = 'none';
        }
        btn.innerHTML = 'Show ID';
      } else {
        for (let idFrame of divID) {
          idFrame.style.display = 'flex';
        }
        btn.innerHTML = 'Hide ID';
      }
    }

    /* Create div frame with key (url), score in BBox (id=0) and Txt (id=1) */
    function createDivFrame(frame, id) { // frame = '/distilled_keyframe/L06/V013/34328.jpg'
      let split = frame.split('/').slice(-3); // ['L06', 'V013', '34328.jpg']
      let idFrame = split.join('_');
      let nVideo = split.slice(0, 2).join('_');
      let nFrame = split[2].split('.')[0];
      let srcImg = split.join('/');
      let divFrame = `
  <div class="divFrame ${nVideo} ${idFrame}" draggable="true" ondragstart="dragFrame(event)" title="${frame}" style="width: ${frameWidth[id]}px; height: ${frameHeight[id]}px;">
    <span class="txtIDFrame" onclick="playVideo('${nVideo}', '${nFrame}')" ${isHideID[id] ? `style="display: none;"` : ''}>${nFrame}</span>
    <img src="../static/distilled_keyframe/${srcImg}" class="imgFrame"/>
    ${id == 1 ? `
    
    <button type="button" class="btnRec button btnRecAndNotRec" ${isFeedback ? '' : `style="display: none;"`} onclick="recFrame(this, ${id}, '${frame}')">
      ‚ñ≤
    </button>
    <button type="button" class="btnUpvote button" ${isUpvote ? '' : `style="display: none;"`} onclick="upvote(this)">
      ‚ù§Ô∏è‚Äçüî•
    </button>
    <button type="button" class="btnNotRec button btnRecAndNotRec" ${isFeedback ? '' : `style="display: none;"`} onclick="notRecFrame(this, ${id}, '${frame}')">
      ‚ñº
    </button>
    <button type="button" class="btnSimilarity button" onclick="similaritySearch('${frame}')">
      üîç
    </button>
    `: ''}
  </div>
  `;
      return [divFrame, nVideo];
    }

    /* Display result (ungroup) in BBox (id=0) and Txt (id=1) */
    function displayRes(id) {
      let containerRes = divRes[id];
      containerRes.innerHTML = '';
      selectedUpvote = new Set();

      let containerFrame = document.createElement('div');
      containerFrame.className = 'divObjRes';
      containerFrame.setAttribute('ondrop', 'dropFrame(event)');
      containerFrame.setAttribute('ondragover', 'allowDrop(event)');

      if (ResDict[id] !== undefined) {
        for (let key in ResDict[id]) {
          let value = ResDict[id][key];
          let frame = value[0]; // score = value[1]
          let divFrame = createDivFrame(frame, id)[0];
          containerFrame.innerHTML += divFrame;
        }
      }
      containerRes.appendChild(containerFrame);
    }


    /* Display result (group) in BBox (id=0) and Txt (id=1) */
    function displayResGroup(id) {
      let containerRes = divRes[id];
      containerRes.innerHTML = '';
      selectedUpvote = new Set();

    if (ResDict[id] !== undefined) {
      for (let key in ResDict[id]) {
        let value = ResDict[id][key];
        let frame = value[0]; // score = value[1]
        let [divFrame, nVideo] = createDivFrame(frame, id);
        let containerFrame = containerRes.getElementsByClassName(nVideo)[0];
        if (!containerFrame) {
          containerFrame = document.createElement('div');
          containerFrame.className = `divObjRes ${nVideo}`;
          containerFrame.setAttribute('ondrop', 'dropFrame(event)');
          containerFrame.setAttribute('ondragover', 'allowDrop(event)');
          containerRes.appendChild(containerFrame);
          // id video
          let divID = document.createElement('span');
          divID.className = 'txtInfoMove ';
          divID.innerHTML = nVideo;
          containerFrame.appendChild(divID);
        }
        containerFrame.innerHTML += divFrame;

        
      }
    }

    }

    /* Remove tag */
    function removeTag(tag) {
      listTags.delete(tag.innerHTML);
      tag.remove();
    }
    /* Add tag */
    function addTag(tag) {
      if (listTags.has(tag)) return;
      listTags.add(tag);
      let containerTags = document.getElementById('containerTags');
      let tagElement = `<div class="itemLabel" onclick="removeTag(this)">${tag}</div>`;
      containerTags.innerHTML += tagElement;
    }

    /* Click Clear tags btn */
    function removeAllTags() {
      listTags.clear();
      let containerTags = document.getElementById('containerTags');
      containerTags.innerHTML = '';
    }

    /* Click Clear boxes btn */
    function removeAllBBoxes() {
      drawingAreas.innerHTML = '';
    }

    /* Clear OCR */
    function removeOCR() {
      inpOCR.value = '';
    }

    /* remove ASR */
    function removeASR() {
      inpASR.value = '';
    }

    /* remove Max Obj */
    function removeMaxObj() {
      inpMaxObj.value = '';
    }

    /* remove Max Color */
    function removeMaxColor() {
      inpMaxColor.value = '';
    }

    /* remove Num Obj */
    function removeNumObj() {
      inpNumObj.value = '';
    }

    /* Click Clear all btn */
    function removeAll() {
      removeAllTags();
      removeAllBBoxes();
      removeOCR();
      removeASR();
      removeMaxObj();
      removeMaxColor();
      removeNumObj();

      let containerRes = divRes[0];
      containerRes.innerHTML = '';

      let querySearch = {'query': ['metadata', 1]};
      fetch('/process_query', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(querySearch) 
      })
      .then(response => response.json())
      .then(data => {});
    }

    /* Click Recommend frame */
    function recFrame(btn, id, frame) {
        if (btn.classList.contains('clickedRec')) {
          btn.classList.remove('clickedRec');
          pos_keyframe_subset.delete(frame);
        } else {
          btn.classList.add('clickedRec');
          pos_keyframe_subset.add(frame);
        }
    }

    /* Click Not Recommend frame */
    function notRecFrame(btn, id, frame) {
      if (btn.classList.contains('clickedRec')) {
        btn.classList.remove('clickedRec');
        neg_keyframe_subset.delete(frame);
      } else {
        btn.classList.add('clickedRec');
        neg_keyframe_subset.add(frame);
      }
    }

    /* Click Upvote frame */
    function upvote(btn) {
      if (btn.classList.contains('clickedVote')) {
        btn.classList.remove('clickedVote');
        selectedUpvote.delete(btn.parentNode);
      } else {
        btn.classList.add('clickedVote');
        selectedUpvote.add(btn.parentNode);
      }
    }

    /* Click Search */
    var btnSearch = document.getElementsByClassName('btnSearch');
    function Search(type) {
      let query = '';
      if (type === 'embedding') {
        query = txtQuery();
        btnSearch[1].classList.add('btnclicked');
        setTimeout(()=>{btnSearch[1].classList.remove('btnclicked');}, 200);
      } else {
        query = metaQuery();
        btnSearch[0].classList.add('btnclicked');
        setTimeout(()=>{btnSearch[0].classList.remove('btnclicked');}, 200);
      }
      let querySearch = {'query': query};
      console.log(querySearch);
      
      fetch('/process_query', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(querySearch)
      })
      .then(response => response.json())
      .then(data => {
        console.log(data);
        if (query[0] === 'metadata') {
          ResDict[0] = {...data};
          if (isGroup[0]) {
            displayResGroup(0);
          } else {
            displayRes(0);
          }
        } else if (query[0] === 'keyframe') {
          ResDict[1] = {...data};
          if (isGroup[1]) {
            displayResGroup(1);
          } else {
            displayRes(1);
          }
        } else {
          ResDict[1] = {...data};
          nHistory++;
          let option = `<option value='${nHistory}'>${nHistory}.${query[4]}  ${query[5]}</option>`;
          historySearch.push({...ResDict[1]});
          selectFilter.innerHTML += option;
          selectFilter.value = nHistory;
          currentHistory = nHistory;
          if (isGroup[1]) {
            displayResGroup(1);
          } else {
            displayRes(1);
          }
          tag_current_query = query[4];
          tag_next_query = query[5];
        }
        
      })
      .catch((error) => {
        console.error('Error:', error);
      });

    }

    /* Click Clear history */
    function clearHistory() {
      selectFilter.innerHTML = "<option value='0'>Empty search history</option>";
      nHistory = 0;
      currentHistory = 0;
      historySearch = [''];

      ResDict[1] = {};

      let containerRes = divRes[1];
      containerRes.innerHTML = '';
      inpL.value = ''; inpV.value = '';

      let querySearch = {'query': ['embedding', 1]};
      fetch('/process_query', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(querySearch)
      })
      .then(response => response.json())
      .then(data => {});
    }

    /* Click Restore history */
    function restoreHistory(id) {
      ResDict[1] = {...historySearch[id]};
      currentHistory = id;
      if (isGroup[1]) {
        displayResGroup(1);
      } else {
        displayRes(1);
      }

      if (id === 0) {
        return;
      }

      let querySearch = {'query': ['embedding', 4, id]};
      fetch('/process_query', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(querySearch)
      })
      .then(response => response.json())
      .then(data => {});
    }

 
    function zoomframe(type, id) { // type = 0 when zoom out, type = 1 when zoom in, id = 0 when BBox, id = 1 when Txt
      let containerRes = divRes[id];
      let listDivFrame = containerRes.getElementsByClassName('divFrame');
      let ratio = type === 0 ? 0.9 : 1.1;
      frameWidth[id] = parseInt(frameWidth[id] * ratio);
      frameHeight[id] = parseInt(frameHeight[id] * ratio);

      for (let divFrame of listDivFrame) {
        divFrame.style.width = frameWidth[id] + 'px';
        divFrame.style.height = frameHeight[id] + 'px';
      }
    }

    function sendFeedback() {
      let txtCurrent = inpTxtCurrent.value;
      let querySearch = {'query': ['embedding', 5, txtCurrent, [...pos_keyframe_subset], [...neg_keyframe_subset]]};
      console.log(querySearch);
      fetch('/process_query', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(querySearch)
      })
      .then(response => response.json())
      .then(data => {
          console.log(data);
          ResDict[1] = {...data};
          if (isGroup[1]) {
            displayResGroup(1);
          } else {
            displayRes(1);
          }
      });
      pos_keyframe_subset = new Set();
      neg_keyframe_subset = new Set();
      let clickRecbtn = divRes[1].getElementsByClassName('clickedRec');
      for (let btn of clickRecbtn) {
        btn.classList.remove('clickedRec');
      }
    }
    var tag_current_query = '', tag_next_query = '';
    function tagRecommend() {
        
        let querySearch = {'query': ['metadata', 4, tag_current_query, tag_next_query]};
        let container = document.getElementById('containerTagRec');
        container.innerHTML = '';
        fetch('/process_query', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(querySearch) 
        })
        .then(response => response.json())
        .then(data => {
          console.log(data);
          for (item of data) {
            let tagElement = `<div class="itemLabel" onclick="addTag(this.innerHTML)">${item}</div>`;
            container.innerHTML += tagElement;
          }
        });
    }
    
    function sendUpvote() {
      if (isGroup[1]) {
        alert('Please ungroup before upvote');
        return;
      }
      if (selectedUpvote.size === 0) {
        alert('Please select frame to upvote');
        return;
      }
      let containerDivFrame = divRes[1].getElementsByClassName('divObjRes')[0];
      Array.from(selectedUpvote).reverse().forEach(frameDiv => {
        containerDivFrame.prepend(frameDiv);
        frameDiv.getElementsByClassName('clickedVote')[0].classList.remove('clickedVote');

      });

        // Clear the set after moving frames
      selectedUpvote = new Set();
    }
    function playVideo(nVideo, nFrame) { //  nVideo="L01_V001" nFrame="00001"
      let querySearch = {'query': ['video', 1, nVideo]}; // get frameRate
      fetch('/process_query', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(querySearch) 
      })
      .then(response => response.json())
      .then(data => {
        console.log(data);
        let type_video = data[0]; 
        let keyframe_time = Math.round(parseInt(nFrame, 10) / data[1]);
        let url_video = data[2];
        if (type_video === 'local_video') { // Show local video
          const newWindow = window.open('', '_blank');
          const htmlContent = `<!DOCTYPE html><html><head><title>${nVideo}</title></head><body><video id="videoPlayer" controls autoplay><source src="${url_video}" type="video/mp4">Your browser does not support the video tag.</video><script>document.getElementById('videoPlayer').onloadedmetadata = function() { this.currentTime = ${keyframe_time}; };` + '</scr' + 'ipt></body></html>';
          // Write HTML content to the new window
          newWindow.document.write(htmlContent);
          // Close the document to finish writing
          newWindow.document.close();
        } else { // open youtube video
          let urlVideo = url_video + '&t=' + keyframe_time + 's';
          console.log(urlVideo);
          const newWindow = window.open(urlVideo, '_blank');
        }
       
        console.log(url_video);
        console.log(keyframe_time);
      });
    }

    const listLabel_Tag = [[
    "airplane", "apple", "backpack", "baseball bat", "baseball glove", "bear", "bed", "bicycle", "bird", "black", "blue", 
    "boat", "book", "bottle", "bowl", "broccoli", "brown", "bus", "cake", "car", "carrot", "cat", "chair", "clock", 
    "cell phone", "couch", "cow", "cup", "dining table", "dog", "donut", "elephant", "fork", "giraffe", "gray", 
    "green", "handbag", "horse", "hot dog", "keyboard", "kite", "knife", "laptop", "microwave", "motorcycle", 
    "mouse", "orange", "oven", "person", "pink", "pizza", "potted plant", "purple", "red", "refrigerator", "remote", 
    "sandwich", "sheep", "skateboard", "skis", "snowboard", "spoon", "sports ball", "suitcase", "surfboard", 
    "tennis racket", "toaster", "toilet", "train", "truck", "tv", "umbrella", "vase", "white", "wine glass", "yellow", 
    "zebra"
], 
["3D CG rendering","3D glasses","abacus","abalone","monastery","belly","academy","accessory","accident","accordion","acorn","acrylic paint","act","action","action film","activity","actor","adaptation","add","adhesive tape","adjust","adult","adventure","advertisement","antenna","aerobics","spray can","afro","agriculture","aid","air conditioner","air conditioning","air sock","aircraft cabin","aircraft model","air field","air line","airliner","airman","plane","airplane window","airport","airport runway","airport terminal","airship","airshow","aisle","alarm","alarm clock","mollymawk","album","album cover","alcohol","alcove","algae","alley","almond","aloe vera","alp","alpaca","alphabet","german shepherd","altar","amber","ambulance","bald eagle","American shorthair","amethyst","amphitheater","amplifier","amusement park","amusement ride","anchor","ancient","anemone","angel","angle","animal","animal sculpture","animal shelter","animation","animation film","animator","anime","ankle","anklet","anniversary","trench coat","ant","antelope","antique","antler","anvil","apartment","ape","app","app icon","appear","appearance","appetizer","applause","apple","apple juice","apple pie","apple tree","applesauce","appliance","appointment","approach","apricot","apron","aqua","aquarium","aquarium fish","aqueduct","arcade","arcade machine","arch","arch bridge","archaelogical excavation","archery","archipelago","architect","architecture","archive","archway","area","arena","argument","arm","armadillo","armband","armchair","armoire","armor","army","army base","army tank","array","arrest","arrow","art","art exhibition","art gallery","art print","art school","art studio","art vector illustration","artichoke","article","artifact","artist","artists loft","ash","ashtray","asia temple","asparagus","asphalt road","assemble","assembly","assembly line","association","astronaut","astronomer","athlete","athletic","atlas","atm","atmosphere","atrium","attach","fighter jet","attend","attraction","atv","eggplant","auction","audi","audio","auditorium","aurora","author","auto factory","auto mechanic","auto part","auto show","auto showroom","car battery","automobile make","automobile model","motor vehicle","autumn","autumn forest","autumn leave","autumn park","autumn tree","avatar","avenue","aviator sunglasses","avocado","award","award ceremony","award winner","shed","ax","azalea","baboon","baby","baby bottle","baby carriage","baby clothe","baby elephant","baby food","baby seat","baby shower","back","backdrop","backlight","backpack","backyard","bacon","badge","badger","badlands","badminton","badminton racket","bag","bagel","bagpipe","baguette","bait","baked goods","baker","bakery","baking","baking sheet","balance","balance car","balcony","ball","ball pit","ballerina","ballet","ballet dancer","ballet skirt","balloon","balloon arch","baseball player","ballroom","bamboo","bamboo forest","banana","banana bread","banana leaf","banana tree","band","band aid","bandage","headscarf","bandeau","bangs","bracelet","balustrade","banjo","bank","bank card","bank vault","banknote","banner","banquet","banquet hall","banyan tree","baozi","baptism","bar","bar code","bar stool","barbecue","barbecue grill","barbell","barber","barber shop","barbie","barge","barista","bark","barley","barn","barn owl","barn door","barrel","barricade","barrier","handcart","bartender","baseball","baseball base","baseball bat","baseball hat","baseball stadium","baseball game","baseball glove","baseball pitcher","baseball team","baseball uniform","basement","basil","basin","basket","basket container","basketball","basketball backboard","basketball coach","basketball court","basketball game","basketball hoop","basketball player","basketball stadium","basketball team","bass","bass guitar","bass horn","bassist","bat","bath","bath heater","bath mat","bath towel","swimwear","bathrobe","bathroom","bathroom accessory","bathroom cabinet","bathroom door","bathroom mirror","bathroom sink","toilet paper","bathroom window","batman","wand","batter","battery","battle","battle rope","battleship","bay","bay bridge","bay window","bayberry","bazaar","beach","beach ball","beach chair","beach house","beach hut","beach towel","beach volleyball","lighthouse","bead","beagle","beak","beaker","beam","bean","bean bag chair","beanbag","bear","bear cub","beard","beast","beat","beautiful","beauty","beauty salon","beaver","bed","bedcover","bed frame","bedroom","bedding","bedpan","bedroom window","bedside lamp","bee","beech tree","beef","beekeeper","beeper","beer","beer bottle","beer can","beer garden","beer glass","beer hall","beet","beetle","beige","clock","bell pepper","bell tower","belt","belt buckle","bench","bend","bengal tiger","bento","beret","berry","berth","beverage","bib","bibimbap","bible","bichon","bicycle","bicycle helmet","bicycle wheel","biker","bidet","big ben","bike lane","bike path","bike racing","bike ride","bikini","bikini top","bill","billard","billboard","billiard table","bin","binder","binocular","biology laboratory","biplane","birch","birch tree","bird","bird bath","bird feeder","bird house","bird nest","birdbath","bird cage","birth","birthday","birthday cake","birthday candle","birthday card","birthday party","biscuit","bishop","bison","bit","bite","black","black sheep","blackberry","blackbird","blackboard","blacksmith","blade","blanket","sports coat","bleacher","blender","blessing","blind","eye mask","flasher","snowstorm","block","blog","blood","bloom","blossom","blouse","blow","hair drier","blowfish","blue","blue artist","blue jay","blue sky","blueberry","bluebird","pig","board","board eraser","board game","boardwalk","boat","boat deck","boat house","paddle","boat ride","bobfloat","bobcat","body","bodyboard","bodybuilder","boiled egg","boiler","bolo tie","bolt","bomb","bomber","bonasa umbellu","bone","bonfire","bonnet","bonsai","book","book cover","bookcase","folder","bookmark","bookshelf","bookstore","boom microphone","boost","boot","border","Border collie","botanical garden","bottle","bottle cap","bottle opener","bottle screw","bougainvillea","boulder","bouquet","boutique","boutique hotel","bow","bow tie","bow window","bowl","bowling","bowling alley","bowling ball","bowling equipment","box","box girder bridge","box turtle","boxer","underdrawers","boxing","boxing glove","boxing ring","boy","brace","bracket","braid","brain","brake","brake light","branch","brand","brandy","brass","brass plaque","bread","breadbox","break","breakfast","seawall","chest","brewery","brick","brick building","wall","brickwork","wedding dress","bride","groom","bridesmaid","bridge","bridle","briefcase","bright","brim","broach","broadcasting","broccoli","bronze","bronze medal","bronze sculpture","bronze statue","brooch","creek","broom","broth","brown","brown bear","brownie","brunch","brunette","brush","coyote","brussels sprout","bubble","bubble gum","bubble tea","bucket cabinet","shield","bud","buddha","buffalo","buffet","bug","build","builder","building","building block","building facade","building material","lamp","bull","bulldog","bullet","bullet train","bulletin board","bulletproof vest","bullfighting","megaphone","bullring","bumblebee","bumper","roll","bundle","bungee","bunk bed","bunker","bunny","buoy","bureau","burial chamber","burn","burrito","bus","bus driver","bus interior","bus station","bus stop","bus window","bush","business","business card","business executive","business suit","business team","business woman","businessman","bust","butcher","butchers shop","butte","butter","cream","butterfly","butterfly house","button","buttonwood","buy","taxi","cabana","cabbage","cabin","cabin car","cabinet","cabinetry","cable","cable car","cactus","cafe","canteen","cage","cake","cake stand","calculator","caldron","calendar","calf","call","phone box","calligraphy","calm","camcorder","camel","camera","camera lens","camouflage","camp","camper","campfire","camping","campsite","campus","can","can opener","canal","canary","cancer","candle","candle holder","candy","candy bar","candy cane","candy store","cane","jar","cannon","canopy","canopy bed","cantaloupe","cantilever bridge","canvas","canyon","cap","cape","cape cod","cappuccino","capsule","captain","capture","car","car dealership","car door","car interior","car logo","car mirror","parking lot","car seat","car show","car wash","car window","caramel","card","card game","cardboard","cardboard box","cardigan","cardinal","cargo","cargo aircraft","cargo ship","caribbean","carnation","carnival","carnivore","carousel","carp","carpenter","carpet","slipper","house finch","coach","dalmatian","aircraft carrier","carrot","carrot cake","carry","cart","carton","cartoon","cartoon character","cartoon illustration","cartoon style","carve","case","cash","cashew","casino","casserole","cassette","cassette deck","plaster bandage","casting","castle","cat","cat bed","cat food","cat furniture","cat tree","catacomb","catamaran","catamount","catch","catcher","caterpillar","catfish","cathedral","cattle","catwalk","catwalk show","cauliflower","cave","caviar","CD","CD player","cedar","ceiling","ceiling fan","celebrate","celebration","celebrity","celery","cello","smartphone","cement","graveyard","centerpiece","centipede","ceramic","ceramic tile","cereal","ceremony","certificate","chain","chain saw","chair","chairlift","daybed","chalet","chalice","chalk","chamber","chameleon","champagne","champagne flute","champion","championship","chandelier","changing table","channel","chap","chapel","character sculpture","charcoal","charge","charger","chariot","charity","charity event","charm","graph","chase","chassis","check","checkbook","chessboard","checklist","cheer","cheerlead","cheese","cheeseburger","cheesecake","cheetah","chef","chemical compound","chemist","chemistry","chemistry lab","cheongsam","cherry","cherry blossom","cherry tomato","cherry tree","chess","chestnut","chicken","chicken breast","chicken coop","chicken salad","chicken wing","garbanzo","chiffonier","chihuahua","child","child actor","childs room","chile","chili dog","chimney","chimpanzee","chinaware","chinese cabbage","chinese garden","chinese knot","chinese rose","chinese tower","chip","chipmunk","chisel","chocolate","chocolate bar","chocolate cake","chocolate chip","chocolate chip cookie","chocolate milk","chocolate mousse","truffle","choir","kitchen knife","cutting board","chopstick","christmas","christmas ball","christmas card","christmas decoration","christmas dinner","christmas eve","christmas hat","christmas light","christmas market","christmas ornament","christmas tree","chrysanthemum","church","church tower","cider","cigar","cigar box","cigarette","cigarette case","waistband","cinema","photographer","cinnamon","circle","circuit","circuit board","circus","water tank","citrus fruit","city","city bus","city hall","city nightview","city park","city skyline","city square","city street","city wall","city view","clam","clarinet","clasp","class","classic","classroom","clavicle","claw","clay","pottery","clean","clean room","cleaner","cleaning product","clear","cleat","clementine","client","cliff","climb","climb mountain","climber","clinic","clip","clip art","clipboard","clipper","clivia","cloak","clogs","close-up","closet","cloth","clothe","clothing","clothespin","clothesline","clothing store","cloud","cloud forest","cloudy","clover","joker","clown fish","club","clutch","clutch bag","coal","coast","coat","coatrack","cob","cock","cockatoo","cocker","cockpit","roach","cocktail","cocktail dress","cocktail shaker","cocktail table","cocoa","coconut","coconut tree","coffee","coffee bean","coffee cup","coffee machine","coffee shop","coffeepot","coffin","cognac","spiral","coin","coke","colander","cold","slaw","collaboration","collage","collection","college student","sheepdog","crash","color","coloring book","coloring material","pony","pillar","comb","combination lock","comic","comedy","comedy film","comet","comfort","comfort food","comic book","comic book character","comic strip","commander","commentator","community","commuter","company","compass","compete","contest","competitor","composer","composition","compost","computer","computer box","computer chair","computer desk","keyboard","computer monitor","computer room","computer screen","computer tower","concept car","concert","concert hall","conch","concrete","condiment","condom","condominium","conductor","cone","meeting","conference center","conference hall","meeting room","confetti","conflict","confluence","connect","connector","conservatory","constellation","construction site","construction worker","contain","container","container ship","continent","profile","contract","control","control tower","convenience store","convention","conversation","converter","convertible","transporter","cook","cooking","cooking spray","cooker","cool","cooler","copper","copy","coral","coral reef","rope","corded phone","liquor","corgi","cork","corkboard","cormorant","corn","corn field","cornbread","corner","trumpet","cornice","cornmeal","corral","corridor","corset","cosmetic","cosmetics brush","cosmetics mirror","cosplay","costume","costumer film designer","infant bed","cottage","cotton","cotton candy","couch","countdown","counter","counter top","country artist","country house","country lane","country pop artist","countryside","coupe","couple","couple photo","courgette","course","court","courthouse","courtyard","cousin","coverall","cow","cowbell","cowboy","cowboy boot","cowboy hat","crab","crabmeat","crack","cradle","craft","craftsman","cranberry","crane","crape","crapper","crate","crater lake","lobster","crayon","cream cheese","cream pitcher","create","creature","credit card","crescent","croissant","crest","crew","cricket","cricket ball","cricket team","cricketer","crochet","crock pot","crocodile","crop","crop top","cross","crossbar","crossroad","crosstalk","crosswalk","crouton","crow","crowbar","crowd","crowded","crown","crt screen","crucifix","cruise","cruise ship","cruiser","crumb","crush","crutch","crystal","cub","cube","cucumber","cue","cuff","cufflink","cuisine","farmland","cup","cupcake","cupid","curb","curl","hair roller","currant","currency","curry","curtain","curve","pad","customer","cut","cutlery","cycle","cycling","cyclone","cylinder","cymbal","cypress","cypress tree","dachshund","daffodil","dagger","dahlia","daikon","dairy","daisy","dam","damage","damp","dance","dance floor","dance room","dancer","dandelion","dark","darkness","dart","dartboard","dashboard","date","daughter","dawn","day bed","daylight","deadbolt","death","debate","debris","decanter","deck","decker bus","decor","decorate","decorative picture","deer","defender","deity","delicatessen","deliver","demolition","monster","demonstration","den","denim jacket","dentist","department store","depression","derby","dermopathy","desert","desert road","design","designer","table","table lamp","desktop","desktop computer","dessert","destruction","detective","detergent","dew","dial","diamond","diaper","diaper bag","journal","die","diet","excavator","number","digital clock","dill","dinner","rowboat","dining room","dinner party","dinning table","dinosaur","dip","diploma","direct","director","dirt","dirt bike","dirt field","dirt road","dirt track","disaster","disciple","disco","disco ball","discotheque","disease","plate","dish antenna","dish washer","dishrag","dishes","dishsoap","Disneyland","dispenser","display","display window","trench","dive","diver","diving board","paper cup","dj","doberman","dock","doctor","document","documentary","dog","dog bed","dog breed","dog collar","dog food","dog house","doll","dollar","dollhouse","dolly","dolphin","dome","domicile","domino","donkey","donut","doodle","door","door handle","doormat","doorplate","doorway","dormitory","dough","downtown","dozer","drag","dragon","dragonfly","drain","drama","drama film","draw","drawer","drawing","drawing pin","pigtail","dress","dress hat","dress shirt","dress shoe","dress suit","dresser","dressing room","dribble","drift","driftwood","drill","drink","drinking water","drive","driver","driveway","drone","drop","droplight","dropper","drought","medicine","pharmacy","drum","drummer","drumstick","dry","duchess","duck","duckbill","duckling","duct tape","dude","duet","duffel","canoe","dumbbell","dumpling","dune","dunk","durian","dusk","dust","garbage truck","dustpan","duvet","DVD","dye","eagle","ear","earmuff","earphone","earplug","earring","earthquake","easel","easter","easter bunny","easter egg","eat","restaurant","eclair","eclipse","ecosystem","edit","education","educator","eel","egg","egg roll","egg tart","eggbeater","egret","Eiffel tower","elastic band","senior","electric chair","electric drill","electrician","electricity","electron","electronic","elephant","elevation map","elevator","elevator car","elevator door","elevator lobby","elevator shaft","embankment","embassy","embellishment","ember","emblem","embroidery","emerald","emergency","emergency service","emergency vehicle","emotion","Empire State Building","enamel","enclosure","side table","energy","engagement","engagement ring","engine","engine room","engineer","engineering","english shorthair","ensemble","enter","entertainer","entertainment","entertainment center","entrance","entrance hall","envelope","equestrian","equipment","eraser","erhu","erosion","escalator","escargot","espresso","estate","estuary","eucalyptus tree","evening","evening dress","evening light","evening sky","evening sun","event","evergreen","ewe","excavation","exercise","exhaust hood","exhibition","exit","explorer","explosion","extension cord","extinguisher","extractor","extrude","eye","eye shadow","eyebrow","eyeliner","fabric","fabric store","facade","face","face close-up","face powder","face towel","facial tissue holder","facility","factory","factory workshop","fair","fairground","fairy","falcon","fall","family","family car","family photo","family room","fan","fang","farm","farmer","farmer market","farmhouse","fashion","fashion accessory","fashion designer","fashion girl","fashion illustration","fashion look","fashion model","fashion show","fast food","fastfood restaurant","father","faucet","fault","fauna","fawn","fax","feast","feather","fedora","feed","feedbag","feeding","feeding chair","feline","mountain lion","fence","fender","fern","ferret","ferris wheel","ferry","fertilizer","festival","fiber","fiction","fiction book","field","field road","fig","fight","figure skater","figurine","file","file photo","file cabinet","fill","film camera","film director","film format","film premiere","film producer","filming","filter","fin","hand","finish line","fir","fir tree","fire","fire alarm","fire department","fire truck","fire escape","fire hose","fire pit","fire station","firecracker","fireman","fireplace","firework","firework display","first-aid kit","fish","fish boat","fish market","fish pond","fishbowl","fisherman","fishing","fishing boat","fishing net","fishing pole","fishing village","fitness","fitness course","five","fixture","fjord","flag","flag pole","flake","flame","flamingo","flannel","flap","flare","flash","flask","flat","flatfish","flavor","flea","flea market","fleet","flight","flight attendant","flip","flip-flop","flipchart","float","flock","flood","floor","floor fan","floor mat","floor plan","floor window","floral arrangement","florist","floss","flour","flow","flower","flower basket","flower bed","flower box","flower field","flower girl","flower market","fluid","flush","flute","fly","fly fishing","flyer","horse","foam","fog","foggy","foie gra","foil","folding chair","leaf","folk artist","folk dance","folk rock artist","fondant","hotpot","font","food","food coloring","food court","food processor","food stand","food truck","foosball","foot","foot bridge","football","football coach","football college game","football match","football field","football game","football helmet","football player","football stadium","football team","path","footprint","footrest","footstall","footwear","forbidden city","ford","forehead","forest","forest fire","forest floor","forest path","forest road","forge","fork","forklift","form","formal garden","formation","formula 1","fort","fortification","forward","fossil","foundation","fountain","fountain pen","fox","frame","freckle","highway","lorry","French","French bulldog","French fries","French toast","freshener","fridge","fried chicken","fried egg","fried rice","friendship","frisbee","frog","frost","frosting","frosty","frozen","fruit","fruit cake","fruit dish","fruit market","fruit salad","fruit stand","fruit tree","fruits shop","fry","frying pan","fudge","fuel","fume hood","fun","funeral","fungi","funnel","fur","fur coat","furniture","futon","gadget","muzzle","galaxy","gallery","game","game board","game controller","ham","gang","garage","garage door","garage kit","garbage","garden","garden asparagus","garden hose","garden spider","gardener","gardening","garfield","gargoyle","wreath","garlic","garment","gas","gas station","gas stove","gasmask","collect","gathering","gauge","gazebo","gear","gecko","geisha","gel","general store","generator","geranium","ghost","gift","gift bag","gift basket","gift box","gift card","gift shop","gift wrap","gig","gin","ginger","gingerbread","gingerbread house","ginkgo tree","giraffe","girl","give","glacier","gladiator","glass bead","glass bottle","glass bowl","glass box","glass building","glass door","glass floor","glass house","glass jar","glass plate","glass table","glass vase","glass wall","glass window","glasses","glaze","glider","earth","glove","glow","glue pudding","go","go for","goal","goalkeeper","goat","goat cheese","gobi","goggles","gold","gold medal","Golden Gate Bridge","golden retriever","goldfish","golf","golf cap","golf cart","golf club","golf course","golfer","goose","gorilla","gothic","gourd","government","government agency","gown","graduate","graduation","grain","grampus","grand prix","grandfather","grandmother","grandparent","granite","granola","grape","grapefruit","wine","grass","grasshopper","grassland","grassy","grater","grave","gravel","gravestone","gravy","gravy boat","gray","graze","grazing","green","greenery","greet","greeting","greeting card","greyhound","grid","griddle","grill","grille","grilled eel","grind","grinder","grits","grocery bag","grotto","ground squirrel","group","group photo","grove","grow","guacamole","guard","guard dog","guest house","guest room","guide","guinea pig","guitar","guitarist","gulf","gull","gun","gundam","gurdwara","guzheng","gym","gymnast","habitat","hacker","hail","hair","hair color","hair spray","hairbrush","haircut","hairgrip","hairnet","hairpin","hairstyle","half","hall","halloween","halloween costume","halloween pumpkin","halter top","hamburg","hamburger","hami melon","hammer","hammock","hamper","hamster","hand dryer","hand glass","hand towel","handbag","handball","handcuff","handgun","handkerchief","handle","handsaw","handshake","handstand","handwriting","hanfu","hang","hangar","hanger","happiness","harbor","harbor seal","hard rock artist","hardback book","safety helmet","hardware","hardware store","hardwood","hardwood floor","mouth organ","pipe organ","harpsichord","harvest","harvester","hassock","hat","hatbox","hautboy","hawthorn","hay","hayfield","hazelnut","head","head coach","headlight","headboard","headdress","headland","headquarter","hearing","heart","heart shape","heat","heater","heather","hedge","hedgehog","heel","helicopter","heliport","helmet","help","hen","henna","herb","herd","hermit crab","hero","heron","hibiscus","hibiscus flower","hide","high bar","high heel","highland","highlight","hike","hiker","hiking boot","hiking equipment","hill","hill country","hill station","hillside","hindu temple","hinge","hip","hip hop artist","hippo","historian","historic","history","hockey","hockey arena","hockey game","hockey player","hockey stick","hoe","hole","vacation","holly","holothurian","home","home appliance","home base","home decor","home interior","home office","home theater","homework","hummus","honey","beehive","honeymoon","hood","hoodie","hook","jump","horizon","hornbill","horned cow","hornet","horror","horror film","horse blanket","horse cart","horse farm","horse ride","horseback","horseshoe","hose","hospital","hospital bed","hospital room","host","inn","hot","hot air balloon","hot dog","hot sauce","hot spring","hotel","hotel lobby","hotel room","hotplate","hourglass","house","house exterior","houseplant","hoverboard","howler","huddle","hug","hula hoop","person","humidifier","hummingbird","humpback whale","hunt","hunting lodge","hurdle","hurricane","husky","hut","hyaena","hybrid","hydrangea","hydrant","seaplane","ice","ice bag","polar bear","ice cave","icecream","ice cream cone","ice cream parlor","ice cube","ice floe","ice hockey player","ice hockey team","lollipop","ice maker","rink","ice sculpture","ice shelf","skate","ice skating","iceberg","icicle","icing","icon","id photo","identity card","igloo","light","iguana","illuminate","illustration","image","impala","incense","independence day","individual","indoor","indoor rower","induction cooker","industrial area","industry","infantry","inflatable boat","information desk","infrastructure","ingredient","inhalator","injection","injury","ink","inking pad","inlet","inscription","insect","install","instrument","insulated cup","interaction","interior design","website","intersection","interview","invertebrate","invitation","ipad","iphone","ipod","iris","iron","ironing board","irrigation system","island","islet","isopod","ivory","ivy","izakaya","jack","jackcrab","jacket","jacuzzi","jade","jaguar","jail cell","jam","japanese garden","jasmine","jaw","jay","jazz","jazz artist","jazz fusion artist","jeans","jeep","jelly","jelly bean","jellyfish","jet","motorboat","jewel","jewellery","jewelry shop","jigsaw puzzle","rickshaw","jockey","jockey cap","jog","joint","journalist","joystick","judge","jug","juggle","juice","juicer","jujube","jump rope","jumpsuit","jungle","junkyard","kale","kaleidoscope","kangaroo","karaoke","karate","karting","kasbah","kayak","kebab","key","keycard","khaki","kick","kilt","kimono","kindergarden classroom","kindergarten","king","king crab","kiss","kit","kitchen","kitchen cabinet","kitchen counter","kitchen floor","kitchen hood","kitchen island","kitchen sink","kitchen table","kitchen utensil","kitchen window","kitchenware","kite","kiwi","knee pad","kneel","knife","rider","knit","knitting needle","knob","knocker","knot","koala","koi","ktv","laboratory","lab coat","label","labrador","maze","lace","lace dress","ladder","ladle","ladybird","lagoon","lake","lake district","lake house","lakeshore","lamb","lamb chop","lamp post","lamp shade","spear","land","land vehicle","landfill","landing","landing deck","landmark","landscape","landslide","lanyard","lantern","lap","laptop","laptop keyboard","larva","lasagne","laser","lash","lasso","latch","latex","latte","laugh","launch","launch event","launch party","laundromat","laundry","laundry basket","laundry room","lava","lavender","lawn","lawn wedding","lawyer","lay","lead","lead singer","lead to","leader","leak","lean","learn","leash","leather","leather jacket","leather shoe","speech","lecture hall","lecture room","ledge","leftover","leg","legend","legging","legislative chamber","lego","legume","lemon","lemon juice","lemonade","lemur","lens","lens flare","lentil","leopard","leotard","tights","leprechaun","lesson","letter","mailbox","letter logo","lettering","lettuce","level","library","license","license plate","lichen","lick","lid","lie","life belt","life jacket","lifeboat","lifeguard","lift","light fixture","light show","light switch","lighting","lightning","lightning rod","lilac","lily","limb","lime","limestone","limo","line","line art","line up","linen","liner","lion","lip balm","lipstick","liquid","liquor store","list","litchi","live","livestock","living room","living space","lizard","load","loading dock","loafer","hallway","locate","lock","lock chamber","locker","loft","log","log cabin","logo","loki","long hair","longboard","loom","loop","lose","lottery","lotus","love","loveseat","luggage","lumber","lumberjack","lunch","lunch box","lush","luxury","luxury yacht","mac","macadamia","macaque","macaroni","macaw","machete","machine","machine gun","magazine","magic","magician","magnet","magnifying glass","magnolia","magpie","mahjong","mahout","maid","chain mail","mail slot","make","makeover","makeup artist","makeup tool","mallard","mallard duck","mallet","mammal","mammoth","man","management","manager","manatee","mandala","mandarin orange","mandarine","mane","manga","manger","mango","mangosteen","mangrove","manhattan","manhole","manhole cover","manicure","mannequin","manor house","mansion","mantid","mantle","manufactured home","manufacturing","manuscript","map","maple","maple leaf","maple syrup","maraca","marathon","marble","march","marching band","mare","marigold","marine","marine invertebrate","marine mammal","puppet","mark","market","market square","market stall","marriage","martial","martial artist","martial arts gym","martini","martini glass","mascara","mascot","mashed potato","masher","mask","massage","mast","mat","matador","match","matchbox","material","mattress","mausoleum","maxi dress","meal","measuring cup","measuring tape","meat","meatball","mechanic","mechanical fan","medal","media","medical equipment","medical image","medical staff","medicine cabinet","medieval","medina","meditation","meerkat","meet","melon","monument","menu","mermaid","net","mess","messenger bag","metal","metal artist","metal detector","meter","mezzanine","microphone","microscope","microwave","midnight","milestone","military uniform","milk","milk can","milk tea","milkshake","mill","mine","miner","mineral","mineral water","miniskirt","miniature","minibus","minister","minivan","mint","mint candy","mirror","miss","missile","mission","mistletoe","mix","mixer","mixing bowl","mixture","moat","mobility scooter","model","model car","modern","modern tower","moisture","mold","molding","mole","monarch","money","monitor","monk","monkey","monkey wrench","monochrome","monocycle","monster truck","moon","moon cake","moonlight","moor","moose","swab","moped","morning","morning fog","morning light","morning sun","mortar","mosaic","mosque","mosquito","moss","motel","moth","mother","motherboard","motif","sport","motor","motorbike","motorcycle","motorcycle helmet","motorcycle racer","motorcyclist","motorsport","mound","mountain","mountain bike","mountain biker","mountain biking","mountain gorilla","mountain lake","mountain landscape","mountain pass","mountain path","mountain range","mountain river","mountain snowy","mountain stream","mountain view","mountain village","mountaineer","mountaineering bag","mouse","mousepad","mousetrap","mouth","mouthwash","move","movie poster","movie ticket","mower","mp3 player","mr","mud","muffin","mug","mulberry","mulch","mule","municipality","mural","muscle","muscle car","museum","mushroom","music","music festival","music stool","music studio","music video performer","musical keyboard","musician","mussel","mustard","mythology","nacho","nail polish","nailfile","nanny","napkin","narrow","national flag","nativity scene","natural history museum","nature","nature reserve","navigation","navratri","navy","nebula","neck","neckband","necklace","neckline","nectar","nectarine","needle","neighbor","neighbourhood","neon","neon light","nerve","nest","new year","newborn","newfoundland","newlywed","news","news conference","newsstand","night","night market","night sky","night view","nightclub","nightstand","noodle","nose","noseband","note","notebook","notepad","notepaper","notice","number icon","nun","nurse","nursery","nursing home","nut","nutcracker","oak","oak tree","oar","oasis","oast house","oatmeal","oats","obelisk","observation tower","observatory","obstacle course","sea","octopus","offer","office","office building","office chair","office cubicle","office desk","office supply","office window","officer","official","oil","oil lamp","oil painting","oilrig","okra","old photo","olive","olive oil","olive tree","omelet","onion","onion ring","opal","open","opening","opening ceremony","opera","opera house","operate","operating room","operation","optical shop","orangutan","orange","orange juice","orange tree","orangery","orbit","orchard","orchestra pit","orchid","order","organization","origami","ornament","osprey","ostrich","otter","out","outcrop","outdoor","outhouse","electric outlet","outline","oval","oven","overall","overcoat","overpass","owl","oyster","teething ring","pack","package","paddock","police van","padlock","paella","pagoda","pain","paint brush","painter","paisley bandanna","palace","palette","paling","pall","palm tree","pan","pancake","panda","panel","panorama","pansy","pant","pantry","pants","pantyhose","papaya","paper","paper bag","paper cutter","paper lantern","paper plate","paper towel","paperback book","paperweight","parachute","parade","paradise","parrot","paramedic","paraquet","parasail","paratrooper","parchment","parish","park","park bench","parking","parking garage","parking meter","parking sign","parliament","parsley","participant","partner","partridge","party","party hat","pass","passage","passbook","passenger","passenger ship","passenger train","passion fruit","passport","pasta","paste","pastry","pasture","patch","patient","pattern","pavement","pavilion","paw","pay","payphone","pea","peace","peach","peacock","peak","peanut","peanut butter","pear","pearl","pebble","pecan","pedestrian","pedestrian bridge","pedestrian street","peel","peeler","pegboard","pegleg","pelican","pen","penalty kick","pencil","pencil case","pencil sharpener","pencil skirt","pendant","pendulum","penguin","peninsula","pennant","penny","piggy bank","peony","pepper","pepper grinder","peppercorn","pepperoni","perch","perform","performance","performance arena","perfume","pergola","persian cat","persimmon","personal care","personal flotation device","pest","pet","pet shop","pet store","petal","petunia","church bench","pheasant","phenomenon","philosopher","phone","phonebook","record player","photo","photo booth","photo frame","photography","physicist","physics laboratory","pianist","piano","plectrum","pick up","pickle","picnic","picnic area","picnic basket","picnic table","picture","picture frame","pie","pigeon","pilgrim","tablet","pillow","pilot","pilot boat","pin","pine","pine cone","pine forest","pine nut","pineapple","table tennis table","table tennis","pink","pint","pipa","pipe","pipe bowl","pirate","pirate flag","pirate ship","pistachio","ski slope","pocket bread","pitaya","pitbull","pitch","pitcher","pitcher plant","pitchfork","pizza","pizza cutter","pizza pan","pizzeria","placard","place","place mat","plaid","plain","plan","planet","planet earth","plank","plant","plantation","planting","plaque","plaster","plastic","plasticine","plateau","platform","platinum","platter","play","play badminton","play baseball","play basketball","play billiard","play football","play pong","play tennis","play volleyball","player","playground","playhouse","playing card","playing chess","playing golf","playing mahjong","playingfield","playpen","playroom","plaza","plier","plot","plow","plug","plug hat","plum","plumber","plumbing fixture","plume","plywood","pocket","pocket watch","pocketknife","pod","podium","poetry","poinsettia","point","pointer","poker card","poker chip","poker table","pole","polecat","police","police car","police dog","police station","politician","polka dot","pollen","pollution","polo","polo neck","polo shirt","pomegranate","pomeranian","poncho","pond","ponytail","poodle","pool","pop","pop artist","popcorn","pope","poppy","porcelain","porch","pork","porridge","portable battery","portal","portfolio","porthole","portrait","portrait session","pose","possum","post","post office","stamp","postcard","poster","poster page","pot","potato","potato chip","potato salad","potholder","potty","pouch","poultry","pound","pour","powder","power line","power plugs and sockets","power see","power station","practice","Prague Castle","prayer","preacher","premiere","prescription","show","presentation","president","press room","pressure cooker","pretzel","prince","princess","print","printed page","printer","printing","prison","produce","product","profession","professional","professor","project picture","projection screen","projector","prom","promenade","propeller","prophet","proposal","protective suit","protest","protester","publication","publicity portrait","ice hockey","pudding","puddle","puff","puffin","pug","pull","pulpit","pulse","pump","pumpkin","pumpkin pie","pumpkin seed","punch bag","punch","student","purple","push","putt","puzzle","tower","pyramid","python","qr code","quail","quarry","quarter","quartz","queen","quesadilla","queue","quiche","quilt","quilting","quote","rabbit","raccoon","race","race track","raceway","race car","racket","radar","radiator","radio","raft","rag doll","rail","railcar","railroad","railroad bridge","railway line","railway station","rain","rain boot","rainbow","rainbow trout","raincoat","rainforest","rainy","raisin","rake","ram","ramp","rapeseed","rapid","rapper","raspberry","rat","ratchet","raven","ravine","ray","razor","razor blade","read","reading","reamer","rear","rear light","rear view","rearview mirror","receipt","receive","reception","recipe","record","record producer","recorder","recording studio","recreation room","recreational vehicle","rectangle","recycling","recycling bin","red","red carpet","red flag","red panda","red wine","redwood","reed","reef","reel","referee","reflect","reflection","reflector","register","rein","reindeer","relax","release","relief","religion","religious","relish","remain","remodel","remote","remove","repair","repair shop","reptile","rescue","rescuer","research","researcher","reservoir","residence","residential neighborhood","resin","resort","resort town","restaurant kitchen","restaurant patio","restroom","retail","retriever","retro","reveal","rhinoceros","rhododendron","rib","ribbon","rice","rice cooker","rice field","ride","ridge","riding","rifle","rim","ring","riot","ripple","rise","rise building","river","river bank","river boat","river valley","riverbed","road","road sign","road trip","roadside","roast chicken","robe","robin","robot","stone","rock arch","rock artist","rock band","rock climber","rock climbing","rock concert","rock face","rock formation","rocker","rocket","rocking chair","rocky","rodent","rodeo","rodeo arena","roe","roe deer","roller","coaster","roller skate","roller skates","rolling pin","romance","romantic","roof","roof garden","room","room divider","root","root beer","rope bridge","rosary","rose","rosemary","rosy cloud","rottweiler","round table","router","row","rowan","royal","rubber stamp","rubble","rubik's cube","ruby","ruffle","rugby","rugby ball","rugby player","ruins","ruler","rum","run","runner","running shoe","rural","rust","rustic","rye","sack","saddle","saddlebag","safari","safe","safety vest","sage","sail","sailboat","sailing","sailor","squirrel monkey","sake","salad","salad bowl","salamander","salami","sale","salmon","salon","salsa","salt","salt and pepper shakers","salt lake","salt marsh","salt shaker","salute","samoyed","samurai","sand","sand bar","sand box","sand castle","sand sculpture","sandal","sandwich","sanitary napkin","santa claus","sapphire","sardine","sari","sashimi","satay","satchel","satellite","satin","sauce","saucer","sauna","sausage","savanna","saw","sawbuck","sax","saxophonist","scaffold","scale","scale model","scallop","scar","strawman","scarf","scene","scenery","schnauzer","school","school bus","school uniform","schoolhouse","schooner","science","science fiction film","science museum","scientist","scissors","wall lamp","scone","scoop","scooter","score","scoreboard","scorpion","scout","scrambled egg","scrap","scraper","scratch","screen","screen door","screenshot","screw","screwdriver","scroll","scrub","scrubbing brush","sculptor","sculpture","sea cave","sea ice","sea lion","sea turtle","sea urchin","seabass","seabed","seabird","seafood","seahorse","seal","sea view","seashell","seaside resort","season","seat","seat belt","seaweed","secretary","security","sedan","see","seed","seesaw","segway","selfie","sell","seminar","sense","sensor","server","server room","service","set","sewing machine","shadow","shake","shaker","shampoo","shape","share","shark","sharpener","sharpie","shaver","shaving cream","shawl","shear","shears","sheep","sheet","sheet music","shelf","shell","shellfish","shelter","shelve","shepherd","sherbert","shiba inu","shine","shipping","shipping container","shipwreck","shipyard","shirt","shirtless","shoal","shoe","shoe box","shoe shop","shoe tree","shoot","shooting basketball guard","shop window","shopfront","shopper","shopping","shopping bag","shopping basket","shopping cart","mall","shopping street","shore","shoreline","short","short hair","shorts","shot glass","shotgun","shoulder","shoulder bag","shovel","showcase","shower","shower cap","shower curtain","shower door","shower head","shredder","shrew","shrimp","shrine","shrub","shutter","siamese","siberia","sibling","side","side cabinet","side dish","sidecar","sideline","siding","sign","signage","signal","signature","silk","silk stocking","silo","silver","silver medal","silverware","sing","singe","singer","sink","sip","sit","sitting","skate park","skateboard","skateboarder","skater","skating rink","skeleton","sketch","skewer","ski","ski boot","ski equipment","ski jacket","ski lift","ski pole","ski resort","snowboard","skier","skiing shoes","skin","skull","skullcap","sky","sky tower","skylight","skyline","skyscraper","slalom","slate","sleigh","sleep","sleeping bag","sleepwear","sleeve","slice","slide","slider","sling","slope","slot","slot machine","sloth","slow cooker","slug","slum","smell","smile","smoke","snack","snail","snake","snapper","snapshot","snorkel","snout","snow","snow leopard","snow mountain","snowball","snowboarder","snowfield","snowflake","snowman","snowmobile","snowplow","snowshoe","snowy","soap","soap bubble","soap dispenser","soccer goalkeeper","socialite","sock","socket","soda","softball","software","solar battery","soldier","solo","solution","sombrero","song","sound","soup","soup bowl","soupspoon","sour cream","souvenir","soybean milk","spa","space","space shuttle","space station","spacecraft","spaghetti","span","wrench","spark","sparkle","sparkler","sparkling wine","sparrow","spatula","speaker","spectator","speech bubble","speed limit","speed limit sign","speedboat","speedometer","sphere","spice","spice rack","spider","spider web","spike","spin","spinach","spire","splash","sponge","spoon","sport association","sport equipment","sport team","sports ball","sports equipment","sports meet","sportswear","dot","spray","spread","spring","spring roll","sprinkle","sprinkler","sprout","spruce","spruce forest","squad","square","squash","squat","squeeze","squid","squirrel","water gun","stab","stable","stack","stadium","staff","stage","stage light","stagecoach","stain","stainless steel","stair","stairs","stairwell","stall","stallion","stand","standing","staple","stapler","star","stare","starfish","starfruit","starling","state park","state school","station","stationary bicycle","stationery","statue","steak","steak knife","steam","steam engine","steam locomotive","steam train","steamed bread","steel","steering wheel","stem","stencil","step stool","stereo","stethoscope","stew","stick","stick insect","sticker","still life","stilt","stingray","stir","stirrer","stirrup","sew","stock","stocking","stomach","stone building","stone carving","stone house","stone mill","stool","stop","stop at","stop light","stop sign","stop watch","traffic light","storage box","storage room","tank","store","storefront","stork","storm","storm cloud","stormy","stove","poker","straddle","strainer","strait","strap","straw","straw hat","strawberry","stream","street art","street artist","street corner","street dog","street food","street light","street market","street photography","street scene","street sign","street vendor","stretch","stretcher","strike","striker","string","string cheese","strip","stripe","stroll","structure","studio","studio shot","stuff","stuffed animal","stuffed toy","stuffing","stump","stunning","stunt","stupa","style","stylus","submarine","submarine sandwich","submarine water","suburb","subway","subway station","subwoofer","succulent","suede","sugar","sugar bowl","sugar cane","sugar cube","suit","suite","summer","summer evening","summit","sun","sun hat","sunbathe","sunday","sundial","sunflower","sunflower field","sunflower seed","sunglasses","sunny","sunrise","sunset","sunshade","sunshine","super bowl","sports car","superhero","supermarket","supermarket shelf","supermodel","supporter","surf","surface","surfboard","surfer","surgeon","surgery","surround","sushi","sushi bar","suspenders","suspension","suspension bridge","suv","swallow","swallowtail butterfly","swamp","swan","swan boat","sweat pant","sweatband","sweater","sweatshirt","sweet","sweet potato","swim","swim cap","swimmer","swimming hole","swimming pool","swing","swing bridge","swinge","swirl","switch","swivel chair","sword","swordfish","symbol","symmetry","synagogue","syringe","syrup","system","t shirt","t-shirt","tabasco sauce","tabby","table tennis racket","table top","tablecloth","tablet computer","tableware","tachometer","tackle","taco","tae kwon do","tai chi","tail","tailor","take","takeoff","talk","tambourine","tan","tangerine","tape","tapestry","tarmac","taro","tarp","tart","tassel","taste","tatami","tattoo","tattoo artist","tavern","tea","tea bag","tea party","tea plantation","tea pot","tea set","teach","teacher","teacup","teal","team photo","team presentation","tear","technician","technology","teddy","tee","teenager","telegraph pole","zoom lens","telescope","television","television camera","television room","television studio","temperature","temple","tempura","tennis","tennis court","tennis match","tennis net","tennis player","tennis racket","tent","tequila","terminal","terrace","terrain","terrarium","territory","test","test match","test tube","text","text message","textile","texture","thanksgiving","thanksgiving dinner","theater","theatre actor","therapy","thermometer","thermos","thermos bottle","thermostat","thicket","thimble","thing","thinking","thistle","throne","throne room","throw","throw pillow","thunder","thunderstorm","thyme","tiara","tick","ticket","ticket booth","tide pool","tie","tiger","tight","tile","tile flooring","tile roof","tile wall","tin","tinfoil","tinsel","tiramisu","tire","tissue","toast","toaster","tobacco","tobacco pipe","toddler","toe","tofu","toilet bowl","toilet seat","toiletry","tokyo tower","tomato","tomato sauce","tomato soup","tomb","tong","tongs","tool","toolbox","toothbrush","toothpaste","toothpick","topiary garden","topping","torch","tornado","tortilla","tortoise","tote bag","totem pole","totoro","toucan","touch","touchdown","tour","tour bus","tour guide","tourist","tourist attraction","tournament","tow truck","towel","towel bar","tower block","tower bridge","town","town square","toy","toy car","toy gun","toyshop","track","tractor","trade","tradition","traditional","traffic","traffic cone","traffic congestion","traffic jam","traffic sign","trail","trailer","trailer truck","train","train bridge","train car","train interior","train track","train window","trainer","training","training bench","training ground","trolley","trampoline","transformer","transparency","travel","tray","treadmill","treat","tree","tree branch","tree farm","tree frog","tree house","tree root","tree trunk","trial","triangle","triathlon","tribe","tributary","trick","tricycle","trim","trio","tripod","trombone","troop","trophy","trophy cup","tropic","trout","truck","truck driver","tub","tube","tugboat","tulip","tuna","tundra","tunnel","turbine","turkey","turn","turnip","turquoise","turret","turtle","tusk","tv actor","tv cabinet","tv drama","tv genre","tv personality","tv show","tv sitcom","tv tower","twig","twilight","twin","twine","twist","type","type on","typewriter","ukulele","ultraman","umbrella","underclothes","underwater","unicorn","uniform","universe","university","up","urban","urinal","urn","use","utensil","utility room","vacuum","valley","valve","vampire","van","vanilla","vanity","variety","vase","vault","vector cartoon illustration","vector icon","vegetable","vegetable garden","vegetable market","vegetation","vehicle","veil","vein","velvet","vending machine","vendor","vent","vespa","vessel","vest","vet","veteran","veterinarians office","viaduct","video","video camera","video game","videotape","view mirror","vigil","villa","village","vine","vinegar","vineyard","violence","violet","violin","violinist","violist","vision","visor","vodka","volcano","volleyball","volleyball court","volleyball player","volunteer","voyage","vulture","waffle","waffle iron","wagon","wagon wheel","waist","waiter","waiting hall","waiting room","walk","walking","walking cane","wall clock","wallpaper","walnut","walrus","war","warehouse","warm","warning sign","warrior","warship","warthog","wash","washer","washing","washing machine","wasp","waste","waste container","watch","water","water bird","water buffalo","water cooler","water drop","water feature","water heater","water level","water lily","water park","water pipe","water purifier","water ski","water sport","water surface","water tower","watercolor","watercolor illustration","watercolor painting","waterfall","watering can","watermark overlay stamp","watermelon","waterproof jacket","waterway","wave","wax","weapon","wear","weather","vane","web","webcam","wedding","wedding ring","wedding bouquet","wedding cake","wedding couple","wedding invitation","wedding party","wedding photo","wedding photographer","wedding photography","wedding reception","wedge","weed","weight","weight scale","welder","well","western food","western restaurant","wet","wet bar","wet suit","wetland","wetsuit","whale","whale shark","wheat","wheat field","wheel","wheelchair","wheelie","whipped cream","whisk","whisker","whiskey","whistle","white","white house","white wine","whiteboard","wicket","wide","wield","wig","Wii","Wii controller","wild","wildebeest","wildfire","wildflower","wildlife","willow","wind","wind chime","wind farm","wind turbine","windmill","window","window box","window display","window frame","window screen","window seat","window sill","wiper","windshield","windy","wine bottle","wine cooler","wine cabinet","wine cellar","wine glass","wine rack","wine tasting","winery","wing","winter","winter melon","winter morning","winter scene","winter sport","winter storm","wire","wisteria","witch","witch hat","wok","wolf","woman","wood","wood duck","wood floor","wood wall","wood-burning stove","wooden spoon","woodland","woodpecker","woodworking plane","wool","job","work card","workbench","worker","workplace","workshop","world","worm","worship","wound","wrap","wrap dress","wrapping paper","wrestle","wrestler","wrinkle","wristband","write","writer","writing","writing brush","writing desk","yacht","yak","yard","yellow","yoga","yoga mat","yoghurt","yoke","yolk","youth","youth hostel","yurt","zebra","zebra crossing","zen garden","zip","zipper","zombie","zongzi","zoo"]
];

var SearchInp = [document.getElementById('inpLabelSearch'), document.getElementById('inpTagSearch')];
var ResSearch = [document.getElementById('containerLabelSearch'), document.getElementById('containerTagSearch')];
    function SearchItems(id) { // id = 0: label, id = 1: tag
      let inp = SearchInp[id].value.toLowerCase().trim();

      if (inp.length < 2) {
        ResSearch[id].innerHTML = '';
        return;
      }
      let container = ResSearch[id];
      container.innerHTML = '';
      let filteredItems = listLabel_Tag[id].filter(item => item.toLowerCase().startsWith(inp));
      console.log(filteredItems);
      let contentHTML = '';
      filteredItems.forEach(item => {
        let splititem = item.split(' ');
        let nameitem = '';
        if (splititem.length > 1) {
          nameitem = splititem.join('_');
        } else nameitem = item;

        if (id === 0) {
         contentHTML = `<div class="itemLabel" draggable="true" ondragstart="drag(event)">${nameitem}</div>`;
        } else {
          contentHTML = `<div class="itemLabel" onclick="addTag(this.innerHTML)">${nameitem}</div>`;
        }
        container.innerHTML += contentHTML;
      });
    }
    
    function similaritySearch(frame) {
      let querySearch = {'query': ['embedding', 6, frame, inpTopkTxt.value, useClipH, useClipH_XLM, useClipL, useBlipVit, useBlipPretrain, useBeit, useBeitLarge]};
      fetch('/process_query', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(querySearch) 
      })
      .then(response => response.json())
      .then(data => {
        ResDict[1] = {...data};
        if (isGroup[1]) {
          displayResGroup(1);
        } else {
          displayRes(1);
        }
      });
    }

    function generateContentCSV() {
      contentcsv = '';
      let vqa_ans = inpVQA.value.trim();
      let countRes = 0;

      let listFrame = divRes[1].getElementsByClassName('divFrame');
      for (let frame of listFrame) {
        let srcframe = frame.title;
        let split = srcframe.split('/').slice(-3); // ['L06', 'V013', '34328.jpg']
        let nVideo = split.slice(0, 2).join('_');
        let nFrame = split[2].split('.')[0];

        let line_res = `${nVideo}, ${nFrame}${vqa_ans !== '' ? ', ' + vqa_ans : ''}\n`;
        contentcsv += line_res;
        countRes++;
        if (countRes === 100) break;
      }
      
      inpPreviewRes.value = contentcsv;
    }

    function ExportRes(btnExport) {
      btnExport.classList.add('btnclicked');
      setTimeout(()=>{btnExport.classList.remove('btnclicked');}, 200);
      let csvContent = inpPreviewRes.value.trim(); // Ensure no extra spaces or new lines

      // Create a Blob from the CSV string
      const blob = new Blob([csvContent], { type: 'text/csv' });

      // Create a link element to download the CSV file
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      let typeQuery = inpVQA.value.trim() == '' ? 'kis' : 'qa';
      let idQuery = inpQueryId.value.trim();
      link.download = `query-${idQuery}-${typeQuery}.csv`;  // Specify the file name for download

      // Append link to the body, trigger the download, and remove the link
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    function openPreview() {
      isPreview = !isPreview;
      if (isPreview) {
        generateContentCSV();
        divPreview.style.display = 'flex';
      } else {
        divPreview.style.display = 'none';
      }

    }
    drawBBoxInit();
    selectFilter.addEventListener('change', function() {
      let id = parseInt(selectFilter.value, 10);
      restoreHistory(id);
    });

    function hideDivMeta() {
      if (divMeta.style.display !== 'flex') {
        divMeta.style.display = 'flex';
      } else {
        divMeta.style.display = 'none';
      }
    }
    
    // Drag drop frame
    var sourceFrame = null;
    function dragFrame(event) {
      sourceFrame = event.target.closest('.divFrame'); 
    }
    function dropFrame(event) {
      event.preventDefault();
      const targetFrame = event.target.closest('.divFrame'); 
      let container = targetFrame.parentNode; 
      container.insertBefore(sourceFrame, targetFrame);
    }

    // Enter to search
    for (let i = 0, maxi = enterToSearchTxt.length; i < maxi; i++) {
      enterToSearchTxt[i].addEventListener('keydown', function(event) {
        if (event.key === "Enter") {
          event.preventDefault(); // NgƒÉn h√†nh ƒë·ªông m·∫∑c ƒë·ªãnh n·∫øu c·∫ßn
          Search('embedding');
        }
      });
    }
    for (let i = 0, maxi = enterToSearchMeta.length; i < maxi; i++) {
      enterToSearchMeta[i].addEventListener('keydown', function(event) {
        if (event.key === "Enter") {
          event.preventDefault(); // NgƒÉn h√†nh ƒë·ªông m·∫∑c ƒë·ªãnh n·∫øu c·∫ßn
          Search('metadata');
        }
      });
    }
   

    inpVQA.addEventListener('keydown', function(event) {
      if (event.key === "Enter") {
        event.preventDefault(); // NgƒÉn h√†nh ƒë·ªông m·∫∑c ƒë·ªãnh n·∫øu c·∫ßn
        openPreview();
      }
    });


</script>
</body>

</html>
